[2025-06-21T16:01:32.874-0300] {logging_mixin.py:154} INFO - Changing /mnt/c/Users/arcan/Documents/airflow/logs/dag_id=PIPELINE_COINGECKO/run_id=manual__2025-06-21T18:59:14.058955+00:00/task_id=run_silver_script permission to 509
[2025-06-21T16:01:33.076-0300] {logging_mixin.py:154} INFO - Changing /mnt/c/Users/arcan/Documents/airflow/logs/dag_id=PIPELINE_COINGECKO/run_id=manual__2025-06-21T18:59:14.058955+00:00/task_id=run_silver_script permission to 509
[2025-06-21T16:01:33.305-0300] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: PIPELINE_COINGECKO.run_silver_script manual__2025-06-21T18:59:14.058955+00:00 [queued]>
[2025-06-21T16:01:33.329-0300] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: PIPELINE_COINGECKO.run_silver_script manual__2025-06-21T18:59:14.058955+00:00 [queued]>
[2025-06-21T16:01:33.329-0300] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2025-06-21T16:01:33.441-0300] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): run_silver_script> on 2025-06-21 18:59:14.058955+00:00
[2025-06-21T16:01:33.447-0300] {standard_task_runner.py:57} INFO - Started process 79897 to run task
[2025-06-21T16:01:33.453-0300] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'PIPELINE_COINGECKO', 'run_silver_script', 'manual__2025-06-21T18:59:14.058955+00:00', '--job-id', '48', '--raw', '--subdir', 'DAGS_FOLDER/pipeline_coingecko.py', '--cfg-path', '/tmp/tmppg1rrrzz']
[2025-06-21T16:01:33.455-0300] {standard_task_runner.py:85} INFO - Job 48: Subtask run_silver_script
[2025-06-21T16:01:33.588-0300] {logging_mixin.py:154} INFO - Changing /mnt/c/Users/arcan/Documents/airflow/logs/dag_id=PIPELINE_COINGECKO/run_id=manual__2025-06-21T18:59:14.058955+00:00/task_id=run_silver_script permission to 509
[2025-06-21T16:01:33.605-0300] {task_command.py:416} INFO - Running <TaskInstance: PIPELINE_COINGECKO.run_silver_script manual__2025-06-21T18:59:14.058955+00:00 [running]> on host YanArcanjo.localdomain
[2025-06-21T16:01:33.834-0300] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='yan_arcanjo' AIRFLOW_CTX_DAG_ID='PIPELINE_COINGECKO' AIRFLOW_CTX_TASK_ID='run_silver_script' AIRFLOW_CTX_EXECUTION_DATE='2025-06-21T18:59:14.058955+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-21T18:59:14.058955+00:00'
[2025-06-21T16:01:33.837-0300] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-21T16:01:33.839-0300] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'spark-submit --packages io.delta:delta-core_2.12:2.4.0             --master local[*]             --conf "spark.sql.extensions=io.delta.sql.DeltaSparkSessionExtension"             --conf "spark.sql.catalog.spark_catalog=org.apache.spark.sql.delta.catalog.DeltaCatalog"             --conf "spark.driver.extraJavaOptions=-Dlog4j.configurationFile=src/jobs/log4j2.properties"             /mnt/c/Users/arcan/Documents/airflow/src/jobs/2-silver/coingecko/coingecko.py coingecko']
[2025-06-21T16:01:33.852-0300] {subprocess.py:86} INFO - Output:
[2025-06-21T16:01:38.385-0300] {subprocess.py:93} INFO - ERROR StatusLogger Reconfiguration failed: No configuration found for '53bd815b' at 'null' in 'null'
[2025-06-21T16:01:38.400-0300] {subprocess.py:93} INFO - ERROR StatusLogger Reconfiguration failed: No configuration found for 'Default' at 'null' in 'null'
[2025-06-21T16:01:39.060-0300] {subprocess.py:93} INFO - 25/06/21 16:01:39 WARN Utils: Your hostname, YanArcanjo resolves to a loopback address: 127.0.1.1; using 10.255.255.254 instead (on interface lo)
[2025-06-21T16:01:39.071-0300] {subprocess.py:93} INFO - 25/06/21 16:01:39 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
[2025-06-21T16:01:39.626-0300] {subprocess.py:93} INFO - :: loading settings :: url = jar:file:/mnt/c/Users/arcan/Documents/airflow/.venv/lib/python3.10/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
[2025-06-21T16:01:39.763-0300] {subprocess.py:93} INFO - Ivy Default Cache set to: /home/yanarcanjo/.ivy2/cache
[2025-06-21T16:01:39.764-0300] {subprocess.py:93} INFO - The jars for the packages stored in: /home/yanarcanjo/.ivy2/jars
[2025-06-21T16:01:39.782-0300] {subprocess.py:93} INFO - io.delta#delta-core_2.12 added as a dependency
[2025-06-21T16:01:39.785-0300] {subprocess.py:93} INFO - :: resolving dependencies :: org.apache.spark#spark-submit-parent-80690846-13c4-4cca-a536-ac93d5a42ba8;1.0
[2025-06-21T16:01:39.786-0300] {subprocess.py:93} INFO - 	confs: [default]
[2025-06-21T16:01:39.967-0300] {subprocess.py:93} INFO - 	found io.delta#delta-core_2.12;2.4.0 in central
[2025-06-21T16:01:40.015-0300] {subprocess.py:93} INFO - 	found io.delta#delta-storage;2.4.0 in central
[2025-06-21T16:01:40.047-0300] {subprocess.py:93} INFO - 	found org.antlr#antlr4-runtime;4.9.3 in central
[2025-06-21T16:01:40.080-0300] {subprocess.py:93} INFO - :: resolution report :: resolve 285ms :: artifacts dl 10ms
[2025-06-21T16:01:40.081-0300] {subprocess.py:93} INFO - 	:: modules in use:
[2025-06-21T16:01:40.082-0300] {subprocess.py:93} INFO - 	io.delta#delta-core_2.12;2.4.0 from central in [default]
[2025-06-21T16:01:40.082-0300] {subprocess.py:93} INFO - 	io.delta#delta-storage;2.4.0 from central in [default]
[2025-06-21T16:01:40.083-0300] {subprocess.py:93} INFO - 	org.antlr#antlr4-runtime;4.9.3 from central in [default]
[2025-06-21T16:01:40.083-0300] {subprocess.py:93} INFO - 	---------------------------------------------------------------------
[2025-06-21T16:01:40.084-0300] {subprocess.py:93} INFO - 	|                  |            modules            ||   artifacts   |
[2025-06-21T16:01:40.084-0300] {subprocess.py:93} INFO - 	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
[2025-06-21T16:01:40.085-0300] {subprocess.py:93} INFO - 	---------------------------------------------------------------------
[2025-06-21T16:01:40.086-0300] {subprocess.py:93} INFO - 	|      default     |   3   |   0   |   0   |   0   ||   3   |   0   |
[2025-06-21T16:01:40.086-0300] {subprocess.py:93} INFO - 	---------------------------------------------------------------------
[2025-06-21T16:01:40.087-0300] {subprocess.py:93} INFO - :: retrieving :: org.apache.spark#spark-submit-parent-80690846-13c4-4cca-a536-ac93d5a42ba8
[2025-06-21T16:01:40.088-0300] {subprocess.py:93} INFO - 	confs: [default]
[2025-06-21T16:01:40.097-0300] {subprocess.py:93} INFO - 	0 artifacts copied, 3 already retrieved (0kB/10ms)
[2025-06-21T16:01:40.609-0300] {subprocess.py:93} INFO - 25/06/21 16:01:40 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-06-21T16:01:42.798-0300] {subprocess.py:93} INFO - 2025-06-21 16:01:42,797 - INFO - Iniciando criação da Spark Session
[2025-06-21T16:01:43.024-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO SparkContext: Running Spark version 3.4.2
[2025-06-21T16:01:43.091-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO ResourceUtils: ==============================================================
[2025-06-21T16:01:43.094-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO ResourceUtils: No custom resources configured for spark.driver.
[2025-06-21T16:01:43.094-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO ResourceUtils: ==============================================================
[2025-06-21T16:01:43.096-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO SparkContext: Submitted application: Spark - Silver
[2025-06-21T16:01:43.180-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
[2025-06-21T16:01:43.201-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO ResourceProfile: Limiting resource is cpu
[2025-06-21T16:01:43.203-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO ResourceProfileManager: Added ResourceProfile id: 0
[2025-06-21T16:01:43.466-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO SecurityManager: Changing view acls to: yanarcanjo
[2025-06-21T16:01:43.468-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO SecurityManager: Changing modify acls to: yanarcanjo
[2025-06-21T16:01:43.469-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO SecurityManager: Changing view acls groups to:
[2025-06-21T16:01:43.471-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO SecurityManager: Changing modify acls groups to:
[2025-06-21T16:01:43.471-0300] {subprocess.py:93} INFO - 25/06/21 16:01:43 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: yanarcanjo; groups with view permissions: EMPTY; users with modify permissions: yanarcanjo; groups with modify permissions: EMPTY
[2025-06-21T16:01:44.332-0300] {subprocess.py:93} INFO - 25/06/21 16:01:44 INFO Utils: Successfully started service 'sparkDriver' on port 35605.
[2025-06-21T16:01:44.419-0300] {subprocess.py:93} INFO - 25/06/21 16:01:44 INFO SparkEnv: Registering MapOutputTracker
[2025-06-21T16:01:44.534-0300] {subprocess.py:93} INFO - 25/06/21 16:01:44 INFO SparkEnv: Registering BlockManagerMaster
[2025-06-21T16:01:44.634-0300] {subprocess.py:93} INFO - 25/06/21 16:01:44 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[2025-06-21T16:01:44.635-0300] {subprocess.py:93} INFO - 25/06/21 16:01:44 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
[2025-06-21T16:01:44.642-0300] {subprocess.py:93} INFO - 25/06/21 16:01:44 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
[2025-06-21T16:01:44.735-0300] {subprocess.py:93} INFO - 25/06/21 16:01:44 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-bcfa7f5e-419a-4789-afaa-4959f0198e94
[2025-06-21T16:01:44.791-0300] {subprocess.py:93} INFO - 25/06/21 16:01:44 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
[2025-06-21T16:01:44.830-0300] {subprocess.py:93} INFO - 25/06/21 16:01:44 INFO SparkEnv: Registering OutputCommitCoordinator
[2025-06-21T16:01:45.237-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
[2025-06-21T16:01:45.424-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
[2025-06-21T16:01:45.450-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Utils: Successfully started service 'SparkUI' on port 4041.
[2025-06-21T16:01:45.546-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO SparkContext: Added JAR file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar at spark://10.255.255.254:35605/jars/io.delta_delta-core_2.12-2.4.0.jar with timestamp 1750532503001
[2025-06-21T16:01:45.547-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO SparkContext: Added JAR file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar at spark://10.255.255.254:35605/jars/io.delta_delta-storage-2.4.0.jar with timestamp 1750532503001
[2025-06-21T16:01:45.548-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO SparkContext: Added JAR file:///home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar at spark://10.255.255.254:35605/jars/org.antlr_antlr4-runtime-4.9.3.jar with timestamp 1750532503001
[2025-06-21T16:01:45.551-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO SparkContext: Added file file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar at file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar with timestamp 1750532503001
[2025-06-21T16:01:45.554-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Utils: Copying /home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/io.delta_delta-core_2.12-2.4.0.jar
[2025-06-21T16:01:45.585-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO SparkContext: Added file file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar at file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar with timestamp 1750532503001
[2025-06-21T16:01:45.586-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Utils: Copying /home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/io.delta_delta-storage-2.4.0.jar
[2025-06-21T16:01:45.594-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO SparkContext: Added file file:///home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar at file:///home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar with timestamp 1750532503001
[2025-06-21T16:01:45.595-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Utils: Copying /home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/org.antlr_antlr4-runtime-4.9.3.jar
[2025-06-21T16:01:45.786-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Executor: Starting executor ID driver on host 10.255.255.254
[2025-06-21T16:01:45.803-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
[2025-06-21T16:01:45.846-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Executor: Fetching file:///home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar with timestamp 1750532503001
[2025-06-21T16:01:45.899-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Utils: /home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar has been previously copied to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/org.antlr_antlr4-runtime-4.9.3.jar
[2025-06-21T16:01:45.907-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Executor: Fetching file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar with timestamp 1750532503001
[2025-06-21T16:01:45.912-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Utils: /home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar has been previously copied to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/io.delta_delta-core_2.12-2.4.0.jar
[2025-06-21T16:01:45.919-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Executor: Fetching file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar with timestamp 1750532503001
[2025-06-21T16:01:45.920-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Utils: /home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar has been previously copied to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/io.delta_delta-storage-2.4.0.jar
[2025-06-21T16:01:45.930-0300] {subprocess.py:93} INFO - 25/06/21 16:01:45 INFO Executor: Fetching spark://10.255.255.254:35605/jars/io.delta_delta-storage-2.4.0.jar with timestamp 1750532503001
[2025-06-21T16:01:46.086-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO TransportClientFactory: Successfully created connection to /10.255.255.254:35605 after 114 ms (0 ms spent in bootstraps)
[2025-06-21T16:01:46.113-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Utils: Fetching spark://10.255.255.254:35605/jars/io.delta_delta-storage-2.4.0.jar to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/fetchFileTemp3905261156709541127.tmp
[2025-06-21T16:01:46.190-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Utils: /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/fetchFileTemp3905261156709541127.tmp has been previously copied to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/io.delta_delta-storage-2.4.0.jar
[2025-06-21T16:01:46.200-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Executor: Adding file:/tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/io.delta_delta-storage-2.4.0.jar to class loader
[2025-06-21T16:01:46.201-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Executor: Fetching spark://10.255.255.254:35605/jars/io.delta_delta-core_2.12-2.4.0.jar with timestamp 1750532503001
[2025-06-21T16:01:46.201-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Utils: Fetching spark://10.255.255.254:35605/jars/io.delta_delta-core_2.12-2.4.0.jar to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/fetchFileTemp6367337398246243246.tmp
[2025-06-21T16:01:46.251-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Utils: /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/fetchFileTemp6367337398246243246.tmp has been previously copied to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/io.delta_delta-core_2.12-2.4.0.jar
[2025-06-21T16:01:46.263-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Executor: Adding file:/tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/io.delta_delta-core_2.12-2.4.0.jar to class loader
[2025-06-21T16:01:46.264-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Executor: Fetching spark://10.255.255.254:35605/jars/org.antlr_antlr4-runtime-4.9.3.jar with timestamp 1750532503001
[2025-06-21T16:01:46.265-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Utils: Fetching spark://10.255.255.254:35605/jars/org.antlr_antlr4-runtime-4.9.3.jar to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/fetchFileTemp2533724755011632340.tmp
[2025-06-21T16:01:46.271-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Utils: /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/fetchFileTemp2533724755011632340.tmp has been previously copied to /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/org.antlr_antlr4-runtime-4.9.3.jar
[2025-06-21T16:01:46.280-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Executor: Adding file:/tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/userFiles-74292df3-5a9a-4314-9484-491775bf52a0/org.antlr_antlr4-runtime-4.9.3.jar to class loader
[2025-06-21T16:01:46.305-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 45469.
[2025-06-21T16:01:46.305-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO NettyBlockTransferService: Server created on 10.255.255.254:45469
[2025-06-21T16:01:46.310-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[2025-06-21T16:01:46.343-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 10.255.255.254, 45469, None)
[2025-06-21T16:01:46.355-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO BlockManagerMasterEndpoint: Registering block manager 10.255.255.254:45469 with 366.3 MiB RAM, BlockManagerId(driver, 10.255.255.254, 45469, None)
[2025-06-21T16:01:46.363-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 10.255.255.254, 45469, None)
[2025-06-21T16:01:46.366-0300] {subprocess.py:93} INFO - 25/06/21 16:01:46 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 10.255.255.254, 45469, None)
[2025-06-21T16:01:47.597-0300] {subprocess.py:93} INFO - 2025-06-21 16:01:47,597 - INFO - Criação da Spark Session Finalizada
[2025-06-21T16:01:47.597-0300] {subprocess.py:93} INFO - 2025-06-21 16:01:47,597 - INFO - Inicio do processamento para coingecko as 2025-06-21 16:01:42
[2025-06-21T16:01:47.598-0300] {subprocess.py:93} INFO - 2025-06-21 16:01:47,597 - INFO - Lendo delta bronze -> /mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko...
[2025-06-21T16:01:47.687-0300] {subprocess.py:93} INFO - 25/06/21 16:01:47 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
[2025-06-21T16:01:47.693-0300] {subprocess.py:93} INFO - 25/06/21 16:01:47 INFO SharedState: Warehouse path is 'file:/tmp/airflowtmp0zgh0va1/spark-warehouse'.
[2025-06-21T16:01:51.418-0300] {subprocess.py:93} INFO - 25/06/21 16:01:51 INFO DelegatingLogStore: LogStore `LogStoreAdapter(io.delta.storage.HDFSLogStore)` is used for scheme `file`
[2025-06-21T16:01:51.886-0300] {subprocess.py:93} INFO - 25/06/21 16:01:51 INFO DeltaLog: Loading version 8.
[2025-06-21T16:01:56.264-0300] {subprocess.py:93} INFO - 25/06/21 16:01:56 INFO DeltaLogFileIndex: Created DeltaLogFileIndex(JSON, numFilesInSegment: 9, totalFileSize: 38696)
[2025-06-21T16:01:59.061-0300] {subprocess.py:93} INFO - 25/06/21 16:01:59 INFO FileSourceStrategy: Pushed Filters:
[2025-06-21T16:01:59.062-0300] {subprocess.py:93} INFO - 25/06/21 16:01:59 INFO FileSourceStrategy: Post-Scan Filters:
[2025-06-21T16:02:00.645-0300] {subprocess.py:93} INFO - 25/06/21 16:02:00 INFO CodeGenerator: Code generated in 857.312137 ms
[2025-06-21T16:02:00.794-0300] {subprocess.py:93} INFO - 25/06/21 16:02:00 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 354.5 KiB, free 366.0 MiB)
[2025-06-21T16:02:00.938-0300] {subprocess.py:93} INFO - 25/06/21 16:02:00 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 365.9 MiB)
[2025-06-21T16:02:00.944-0300] {subprocess.py:93} INFO - 25/06/21 16:02:00 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 10.255.255.254:45469 (size: 35.4 KiB, free: 366.3 MiB)
[2025-06-21T16:02:00.955-0300] {subprocess.py:93} INFO - 25/06/21 16:02:00 INFO SparkContext: Created broadcast 0 from toString at String.java:2994
[2025-06-21T16:02:01.029-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2025-06-21T16:02:01.416-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO SparkContext: Starting job: toString at String.java:2994
[2025-06-21T16:02:01.457-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO DAGScheduler: Got job 0 (toString at String.java:2994) with 9 output partitions
[2025-06-21T16:02:01.458-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO DAGScheduler: Final stage: ResultStage 0 (toString at String.java:2994)
[2025-06-21T16:02:01.459-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO DAGScheduler: Parents of final stage: List()
[2025-06-21T16:02:01.462-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO DAGScheduler: Missing parents: List()
[2025-06-21T16:02:01.472-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at toString at String.java:2994), which has no missing parents
[2025-06-21T16:02:01.538-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 50.4 KiB, free 365.9 MiB)
[2025-06-21T16:02:01.548-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 15.6 KiB, free 365.9 MiB)
[2025-06-21T16:02:01.549-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 10.255.255.254:45469 (size: 15.6 KiB, free: 366.3 MiB)
[2025-06-21T16:02:01.554-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1535
[2025-06-21T16:02:01.591-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO DAGScheduler: Submitting 9 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at toString at String.java:2994) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8))
[2025-06-21T16:02:01.594-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSchedulerImpl: Adding task set 0.0 with 9 tasks resource profile 0
[2025-06-21T16:02:01.718-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (10.255.255.254, executor driver, partition 0, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:01.724-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSetManager: Starting task 1.0 in stage 0.0 (TID 1) (10.255.255.254, executor driver, partition 1, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:01.727-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSetManager: Starting task 2.0 in stage 0.0 (TID 2) (10.255.255.254, executor driver, partition 2, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:01.729-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSetManager: Starting task 3.0 in stage 0.0 (TID 3) (10.255.255.254, executor driver, partition 3, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:01.730-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSetManager: Starting task 4.0 in stage 0.0 (TID 4) (10.255.255.254, executor driver, partition 4, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:01.732-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSetManager: Starting task 5.0 in stage 0.0 (TID 5) (10.255.255.254, executor driver, partition 5, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:01.733-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSetManager: Starting task 6.0 in stage 0.0 (TID 6) (10.255.255.254, executor driver, partition 6, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:01.734-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSetManager: Starting task 7.0 in stage 0.0 (TID 7) (10.255.255.254, executor driver, partition 7, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:01.735-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO TaskSetManager: Starting task 8.0 in stage 0.0 (TID 8) (10.255.255.254, executor driver, partition 8, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:01.761-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO Executor: Running task 3.0 in stage 0.0 (TID 3)
[2025-06-21T16:02:01.762-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO Executor: Running task 2.0 in stage 0.0 (TID 2)
[2025-06-21T16:02:01.762-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO Executor: Running task 7.0 in stage 0.0 (TID 7)
[2025-06-21T16:02:01.764-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO Executor: Running task 1.0 in stage 0.0 (TID 1)
[2025-06-21T16:02:01.764-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO Executor: Running task 8.0 in stage 0.0 (TID 8)
[2025-06-21T16:02:01.765-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO Executor: Running task 4.0 in stage 0.0 (TID 4)
[2025-06-21T16:02:01.765-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO Executor: Running task 6.0 in stage 0.0 (TID 6)
[2025-06-21T16:02:01.765-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
[2025-06-21T16:02:01.766-0300] {subprocess.py:93} INFO - 25/06/21 16:02:01 INFO Executor: Running task 5.0 in stage 0.0 (TID 5)
[2025-06-21T16:02:02.459-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000002.json, range: 0-6443, partition values: [empty row]
[2025-06-21T16:02:02.461-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000005.json, range: 0-4044, partition values: [empty row]
[2025-06-21T16:02:02.462-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000000.json, range: 0-5049, partition values: [empty row]
[2025-06-21T16:02:02.463-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000007.json, range: 0-4050, partition values: [empty row]
[2025-06-21T16:02:02.464-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000008.json, range: 0-4041, partition values: [empty row]
[2025-06-21T16:02:02.465-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000003.json, range: 0-4048, partition values: [empty row]
[2025-06-21T16:02:02.465-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000006.json, range: 0-4046, partition values: [empty row]
[2025-06-21T16:02:02.466-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000001.json, range: 0-2925, partition values: [empty row]
[2025-06-21T16:02:02.468-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000004.json, range: 0-4050, partition values: [empty row]
[2025-06-21T16:02:02.533-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO CodeGenerator: Code generated in 55.08889 ms
[2025-06-21T16:02:02.878-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO Executor: Finished task 7.0 in stage 0.0 (TID 7). 1673 bytes result sent to driver
[2025-06-21T16:02:02.879-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO Executor: Finished task 8.0 in stage 0.0 (TID 8). 1673 bytes result sent to driver
[2025-06-21T16:02:02.880-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO Executor: Finished task 2.0 in stage 0.0 (TID 2). 1673 bytes result sent to driver
[2025-06-21T16:02:02.881-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO Executor: Finished task 4.0 in stage 0.0 (TID 4). 1673 bytes result sent to driver
[2025-06-21T16:02:02.883-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO Executor: Finished task 6.0 in stage 0.0 (TID 6). 1673 bytes result sent to driver
[2025-06-21T16:02:02.884-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO Executor: Finished task 5.0 in stage 0.0 (TID 5). 1673 bytes result sent to driver
[2025-06-21T16:02:02.884-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO Executor: Finished task 1.0 in stage 0.0 (TID 1). 2347 bytes result sent to driver
[2025-06-21T16:02:02.885-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO Executor: Finished task 3.0 in stage 0.0 (TID 3). 1673 bytes result sent to driver
[2025-06-21T16:02:02.885-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 2402 bytes result sent to driver
[2025-06-21T16:02:02.904-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSetManager: Finished task 8.0 in stage 0.0 (TID 8) in 1168 ms on 10.255.255.254 (executor driver) (1/9)
[2025-06-21T16:02:02.908-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSetManager: Finished task 6.0 in stage 0.0 (TID 6) in 1175 ms on 10.255.255.254 (executor driver) (2/9)
[2025-06-21T16:02:02.909-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1212 ms on 10.255.255.254 (executor driver) (3/9)
[2025-06-21T16:02:02.910-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSetManager: Finished task 1.0 in stage 0.0 (TID 1) in 1186 ms on 10.255.255.254 (executor driver) (4/9)
[2025-06-21T16:02:02.911-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSetManager: Finished task 7.0 in stage 0.0 (TID 7) in 1176 ms on 10.255.255.254 (executor driver) (5/9)
[2025-06-21T16:02:02.911-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSetManager: Finished task 3.0 in stage 0.0 (TID 3) in 1182 ms on 10.255.255.254 (executor driver) (6/9)
[2025-06-21T16:02:02.912-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSetManager: Finished task 2.0 in stage 0.0 (TID 2) in 1185 ms on 10.255.255.254 (executor driver) (7/9)
[2025-06-21T16:02:02.913-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSetManager: Finished task 4.0 in stage 0.0 (TID 4) in 1181 ms on 10.255.255.254 (executor driver) (8/9)
[2025-06-21T16:02:02.914-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSetManager: Finished task 5.0 in stage 0.0 (TID 5) in 1180 ms on 10.255.255.254 (executor driver) (9/9)
[2025-06-21T16:02:02.914-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool
[2025-06-21T16:02:02.933-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO DAGScheduler: ResultStage 0 (toString at String.java:2994) finished in 1.417 s
[2025-06-21T16:02:02.940-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
[2025-06-21T16:02:02.941-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
[2025-06-21T16:02:02.944-0300] {subprocess.py:93} INFO - 25/06/21 16:02:02 INFO DAGScheduler: Job 0 finished: toString at String.java:2994, took 1.527508 s
[2025-06-21T16:02:03.056-0300] {subprocess.py:93} INFO - 25/06/21 16:02:03 INFO CodeGenerator: Code generated in 59.909422 ms
[2025-06-21T16:02:03.079-0300] {subprocess.py:93} INFO - 25/06/21 16:02:03 INFO Snapshot: [tableId=3d00b60b-6e35-48d3-93a8-54ac64a192e3] Created snapshot Snapshot(path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log, version=8, metadata=Metadata(02c8a9fd-7688-4d17-b5bb-6360b5fc3af6,null,null,Format(parquet,Map()),{"type":"struct","fields":[{"name":"ath","type":"double","nullable":true,"metadata":{}},{"name":"ath_change_percentage","type":"double","nullable":true,"metadata":{}},{"name":"ath_date","type":"string","nullable":true,"metadata":{}},{"name":"atl","type":"double","nullable":true,"metadata":{}},{"name":"atl_change_percentage","type":"double","nullable":true,"metadata":{}},{"name":"atl_date","type":"string","nullable":true,"metadata":{}},{"name":"circulating_supply","type":"double","nullable":true,"metadata":{}},{"name":"current_price","type":"double","nullable":true,"metadata":{}},{"name":"fully_diluted_valuation","type":"long","nullable":true,"metadata":{}},{"name":"high_24h","type":"double","nullable":true,"metadata":{}},{"name":"id","type":"string","nullable":true,"metadata":{}},{"name":"image","type":"string","nullable":true,"metadata":{}},{"name":"last_updated","type":"string","nullable":true,"metadata":{}},{"name":"low_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap","type":"long","nullable":true,"metadata":{}},{"name":"market_cap_change_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap_change_percentage_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap_rank","type":"long","nullable":true,"metadata":{}},{"name":"max_supply","type":"double","nullable":true,"metadata":{}},{"name":"name","type":"string","nullable":true,"metadata":{}},{"name":"price_change_24h","type":"double","nullable":true,"metadata":{}},{"name":"price_change_percentage_24h","type":"double","nullable":true,"metadata":{}},{"name":"symbol","type":"string","nullable":true,"metadata":{}},{"name":"total_supply","type":"double","nullable":true,"metadata":{}},{"name":"total_volume","type":"double","nullable":true,"metadata":{}},{"name":"key_log_file_path","type":"string","nullable":true,"metadata":{}},{"name":"dt_atualizacao","type":"string","nullable":true,"metadata":{}},{"name":"dt_ingestao","type":"string","nullable":true,"metadata":{}},{"name":"nm_arquivo_origem","type":"string","nullable":true,"metadata":{}},{"name":"hash_chave","type":"string","nullable":true,"metadata":{}},{"name":"hash_columns","type":"string","nullable":true,"metadata":{}}]},List(),Map(),Some(1750355014043)), logSegment=LogSegment(file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log,8,WrappedArray(DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000000.json; isDirectory=false; length=5049; replication=1; blocksize=33554432; modification_time=1750355014370; access_time=1750355014370; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000001.json; isDirectory=false; length=2925; replication=1; blocksize=33554432; modification_time=1750356194967; access_time=1750356194967; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000002.json; isDirectory=false; length=6443; replication=1; blocksize=33554432; modification_time=1750356316261; access_time=1750356316261; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000003.json; isDirectory=false; length=4048; replication=1; blocksize=33554432; modification_time=1750357036143; access_time=1750357036143; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000004.json; isDirectory=false; length=4050; replication=1; blocksize=33554432; modification_time=1750358332518; access_time=1750358332518; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000005.json; isDirectory=false; length=4044; replication=1; blocksize=33554432; modification_time=1750359006032; access_time=1750359006032; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000006.json; isDirectory=false; length=4046; replication=1; blocksize=33554432; modification_time=1750530297326; access_time=1750530297326; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000007.json; isDirectory=false; length=4050; replication=1; blocksize=33554432; modification_time=1750531389467; access_time=1750531389467; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000008.json; isDirectory=false; length=4041; replication=1; blocksize=33554432; modification_time=1750532449505; access_time=1750532449505; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}),None,1750532449505), checksumOpt=None)
[2025-06-21T16:02:05.576-0300] {subprocess.py:93} INFO - 2025-06-21 16:02:05,575 - INFO - Selecionando os registros mais recentes de cada hash chave
[2025-06-21T16:02:05.930-0300] {subprocess.py:93} INFO - 25/06/21 16:02:05 INFO DelegatingLogStore: LogStore `LogStoreAdapter(io.delta.storage.HDFSLogStore)` is used for scheme `file`
[2025-06-21T16:02:06.000-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DeltaLog: Loading version 0.
[2025-06-21T16:02:06.007-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DeltaLogFileIndex: Created DeltaLogFileIndex(JSON, numFilesInSegment: 1, totalFileSize: 6272)
[2025-06-21T16:02:06.110-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO FileSourceStrategy: Pushed Filters:
[2025-06-21T16:02:06.110-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO FileSourceStrategy: Post-Scan Filters:
[2025-06-21T16:02:06.143-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 354.5 KiB, free 365.5 MiB)
[2025-06-21T16:02:06.156-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 365.5 MiB)
[2025-06-21T16:02:06.158-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 10.255.255.254:45469 (size: 35.4 KiB, free: 366.2 MiB)
[2025-06-21T16:02:06.160-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO SparkContext: Created broadcast 2 from toString at String.java:2994
[2025-06-21T16:02:06.161-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2025-06-21T16:02:06.189-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO SparkContext: Starting job: toString at String.java:2994
[2025-06-21T16:02:06.192-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DAGScheduler: Got job 1 (toString at String.java:2994) with 1 output partitions
[2025-06-21T16:02:06.192-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DAGScheduler: Final stage: ResultStage 1 (toString at String.java:2994)
[2025-06-21T16:02:06.193-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DAGScheduler: Parents of final stage: List()
[2025-06-21T16:02:06.193-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DAGScheduler: Missing parents: List()
[2025-06-21T16:02:06.195-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[7] at toString at String.java:2994), which has no missing parents
[2025-06-21T16:02:06.199-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 50.4 KiB, free 365.4 MiB)
[2025-06-21T16:02:06.204-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 15.6 KiB, free 365.4 MiB)
[2025-06-21T16:02:06.205-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 10.255.255.254:45469 (size: 15.6 KiB, free: 366.2 MiB)
[2025-06-21T16:02:06.205-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1535
[2025-06-21T16:02:06.206-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[7] at toString at String.java:2994) (first 15 tasks are for partitions Vector(0))
[2025-06-21T16:02:06.207-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks resource profile 0
[2025-06-21T16:02:06.208-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 9) (10.255.255.254, executor driver, partition 0, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T16:02:06.209-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO Executor: Running task 0.0 in stage 1.0 (TID 9)
[2025-06-21T16:02:06.216-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/3-silver/coingecko/_delta_log/00000000000000000000.json, range: 0-6272, partition values: [empty row]
[2025-06-21T16:02:06.284-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO Executor: Finished task 0.0 in stage 1.0 (TID 9). 2364 bytes result sent to driver
[2025-06-21T16:02:06.285-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 9) in 78 ms on 10.255.255.254 (executor driver) (1/1)
[2025-06-21T16:02:06.286-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool
[2025-06-21T16:02:06.287-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DAGScheduler: ResultStage 1 (toString at String.java:2994) finished in 0.090 s
[2025-06-21T16:02:06.288-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
[2025-06-21T16:02:06.289-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
[2025-06-21T16:02:06.290-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO DAGScheduler: Job 1 finished: toString at String.java:2994, took 0.099458 s
[2025-06-21T16:02:06.303-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO Snapshot: [tableId=e8d6af53-b727-45ca-8a23-dfb23fed3378] Created snapshot Snapshot(path=file:/mnt/c/Users/arcan/Documents/airflow/data/3-silver/coingecko/_delta_log, version=0, metadata=Metadata(87c52a9c-9162-4131-83ba-34d9aee57383,null,null,Format(parquet,Map()),{"type":"struct","fields":[{"name":"ath","type":"double","nullable":true,"metadata":{}},{"name":"ath_change_percentage","type":"double","nullable":true,"metadata":{}},{"name":"ath_date","type":"string","nullable":true,"metadata":{}},{"name":"atl","type":"double","nullable":true,"metadata":{}},{"name":"atl_change_percentage","type":"double","nullable":true,"metadata":{}},{"name":"atl_date","type":"string","nullable":true,"metadata":{}},{"name":"circulating_supply","type":"double","nullable":true,"metadata":{}},{"name":"current_price","type":"double","nullable":true,"metadata":{}},{"name":"fully_diluted_valuation","type":"long","nullable":true,"metadata":{}},{"name":"high_24h","type":"double","nullable":true,"metadata":{}},{"name":"id","type":"string","nullable":true,"metadata":{}},{"name":"image","type":"string","nullable":true,"metadata":{}},{"name":"last_updated","type":"string","nullable":true,"metadata":{}},{"name":"low_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap","type":"long","nullable":true,"metadata":{}},{"name":"market_cap_change_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap_change_percentage_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap_rank","type":"long","nullable":true,"metadata":{}},{"name":"max_supply","type":"double","nullable":true,"metadata":{}},{"name":"name","type":"string","nullable":true,"metadata":{}},{"name":"price_change_24h","type":"double","nullable":true,"metadata":{}},{"name":"price_change_percentage_24h","type":"double","nullable":true,"metadata":{}},{"name":"symbol","type":"string","nullable":true,"metadata":{}},{"name":"total_supply","type":"double","nullable":true,"metadata":{}},{"name":"total_volume","type":"double","nullable":true,"metadata":{}},{"name":"hash_chave","type":"string","nullable":true,"metadata":{}},{"name":"hash_columns","type":"string","nullable":true,"metadata":{}},{"name":"key_log_file_path","type":"string","nullable":true,"metadata":{}},{"name":"dt_atualizacao","type":"string","nullable":true,"metadata":{}},{"name":"dt_ingestao","type":"string","nullable":true,"metadata":{}},{"name":"nm_arquivo_origem","type":"string","nullable":true,"metadata":{}}]},List(),Map(),Some(1750528855635)), logSegment=LogSegment(file:/mnt/c/Users/arcan/Documents/airflow/data/3-silver/coingecko/_delta_log,0,WrappedArray(DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/3-silver/coingecko/_delta_log/00000000000000000000.json; isDirectory=false; length=6272; replication=1; blocksize=33554432; modification_time=1750528861569; access_time=1750528861569; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}),None,1750528861569), checksumOpt=None)
[2025-06-21T16:02:06.305-0300] {subprocess.py:93} INFO - 2025-06-21 16:02:06,305 - INFO - Filtrando os dados que necessitam ser atualizados ou inseridos
[2025-06-21T16:02:06.425-0300] {subprocess.py:93} INFO - 2025-06-21 16:02:06,424 - ERROR - Erro na execução: 'DataFrame' object has no attribute 'hash_colums'
[2025-06-21T16:02:06.425-0300] {subprocess.py:93} INFO - 2025-06-21 16:02:06,425 - INFO - Closing down clientserver connection
[2025-06-21T16:02:06.479-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO SparkContext: Invoking stop() from shutdown hook
[2025-06-21T16:02:06.479-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO SparkContext: SparkContext is stopping with exitCode 0.
[2025-06-21T16:02:06.502-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO SparkUI: Stopped Spark web UI at http://10.255.255.254:4041
[2025-06-21T16:02:06.531-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
[2025-06-21T16:02:06.551-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO MemoryStore: MemoryStore cleared
[2025-06-21T16:02:06.552-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO BlockManager: BlockManager stopped
[2025-06-21T16:02:06.581-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO BlockManagerMaster: BlockManagerMaster stopped
[2025-06-21T16:02:06.588-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
[2025-06-21T16:02:06.602-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO SparkContext: Successfully stopped SparkContext
[2025-06-21T16:02:06.603-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO ShutdownHookManager: Shutdown hook called
[2025-06-21T16:02:06.603-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO ShutdownHookManager: Deleting directory /tmp/spark-76067803-7802-466d-86ca-3d3535117d70
[2025-06-21T16:02:06.613-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO ShutdownHookManager: Deleting directory /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3
[2025-06-21T16:02:06.620-0300] {subprocess.py:93} INFO - 25/06/21 16:02:06 INFO ShutdownHookManager: Deleting directory /tmp/spark-cb27acdb-8970-43e9-847e-6a30be9b3fe3/pyspark-f0c34edd-eb79-4b27-afdc-fb62817af516
[2025-06-21T16:02:06.822-0300] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-21T16:02:06.887-0300] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=PIPELINE_COINGECKO, task_id=run_silver_script, execution_date=20250621T185914, start_date=20250621T190133, end_date=20250621T190206
[2025-06-21T16:02:06.977-0300] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-06-21T16:02:07.025-0300] {taskinstance.py:2778} INFO - 1 downstream tasks scheduled from follow-on schedule check
