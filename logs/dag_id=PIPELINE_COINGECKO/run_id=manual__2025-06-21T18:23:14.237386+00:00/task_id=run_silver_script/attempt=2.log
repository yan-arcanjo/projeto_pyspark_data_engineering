[2025-06-21T15:31:03.081-0300] {logging_mixin.py:154} INFO - Changing /mnt/c/Users/arcan/Documents/airflow/logs/dag_id=PIPELINE_COINGECKO/run_id=manual__2025-06-21T18:23:14.237386+00:00/task_id=run_silver_script permission to 509
[2025-06-21T15:31:03.324-0300] {logging_mixin.py:154} INFO - Changing /mnt/c/Users/arcan/Documents/airflow/logs/dag_id=PIPELINE_COINGECKO/run_id=manual__2025-06-21T18:23:14.237386+00:00/task_id=run_silver_script permission to 509
[2025-06-21T15:31:03.533-0300] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: PIPELINE_COINGECKO.run_silver_script manual__2025-06-21T18:23:14.237386+00:00 [queued]>
[2025-06-21T15:31:03.553-0300] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: PIPELINE_COINGECKO.run_silver_script manual__2025-06-21T18:23:14.237386+00:00 [queued]>
[2025-06-21T15:31:03.554-0300] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2025-06-21T15:31:03.603-0300] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): run_silver_script> on 2025-06-21 18:23:14.237386+00:00
[2025-06-21T15:31:03.609-0300] {standard_task_runner.py:57} INFO - Started process 77652 to run task
[2025-06-21T15:31:03.614-0300] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'PIPELINE_COINGECKO', 'run_silver_script', 'manual__2025-06-21T18:23:14.237386+00:00', '--job-id', '38', '--raw', '--subdir', 'DAGS_FOLDER/pipeline_coingecko.py', '--cfg-path', '/tmp/tmpl0safl9p']
[2025-06-21T15:31:03.617-0300] {standard_task_runner.py:85} INFO - Job 38: Subtask run_silver_script
[2025-06-21T15:31:03.735-0300] {logging_mixin.py:154} INFO - Changing /mnt/c/Users/arcan/Documents/airflow/logs/dag_id=PIPELINE_COINGECKO/run_id=manual__2025-06-21T18:23:14.237386+00:00/task_id=run_silver_script permission to 509
[2025-06-21T15:31:03.759-0300] {task_command.py:416} INFO - Running <TaskInstance: PIPELINE_COINGECKO.run_silver_script manual__2025-06-21T18:23:14.237386+00:00 [running]> on host YanArcanjo.localdomain
[2025-06-21T15:31:03.922-0300] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='yan_arcanjo' AIRFLOW_CTX_DAG_ID='PIPELINE_COINGECKO' AIRFLOW_CTX_TASK_ID='run_silver_script' AIRFLOW_CTX_EXECUTION_DATE='2025-06-21T18:23:14.237386+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-21T18:23:14.237386+00:00'
[2025-06-21T15:31:03.925-0300] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-21T15:31:03.928-0300] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'spark-submit --packages io.delta:delta-core_2.12:2.4.0             --master local[*]             --conf "spark.sql.extensions=io.delta.sql.DeltaSparkSessionExtension"             --conf "spark.sql.catalog.spark_catalog=org.apache.spark.sql.delta.catalog.DeltaCatalog"             --conf "spark.driver.extraJavaOptions=-Dlog4j.configurationFile=src/jobs/log4j2.properties"             /mnt/c/Users/arcan/Documents/airflow/src/jobs/1-silver/coingecko/coingecko.py coingecko']
[2025-06-21T15:31:03.937-0300] {subprocess.py:86} INFO - Output:
[2025-06-21T15:31:08.860-0300] {subprocess.py:93} INFO - ERROR StatusLogger Reconfiguration failed: No configuration found for '53bd815b' at 'null' in 'null'
[2025-06-21T15:31:08.881-0300] {subprocess.py:93} INFO - ERROR StatusLogger Reconfiguration failed: No configuration found for 'Default' at 'null' in 'null'
[2025-06-21T15:31:09.563-0300] {subprocess.py:93} INFO - 25/06/21 15:31:09 WARN Utils: Your hostname, YanArcanjo resolves to a loopback address: 127.0.1.1; using 10.255.255.254 instead (on interface lo)
[2025-06-21T15:31:09.571-0300] {subprocess.py:93} INFO - 25/06/21 15:31:09 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
[2025-06-21T15:31:10.110-0300] {subprocess.py:93} INFO - :: loading settings :: url = jar:file:/mnt/c/Users/arcan/Documents/airflow/.venv/lib/python3.10/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
[2025-06-21T15:31:10.257-0300] {subprocess.py:93} INFO - Ivy Default Cache set to: /home/yanarcanjo/.ivy2/cache
[2025-06-21T15:31:10.257-0300] {subprocess.py:93} INFO - The jars for the packages stored in: /home/yanarcanjo/.ivy2/jars
[2025-06-21T15:31:10.271-0300] {subprocess.py:93} INFO - io.delta#delta-core_2.12 added as a dependency
[2025-06-21T15:31:10.274-0300] {subprocess.py:93} INFO - :: resolving dependencies :: org.apache.spark#spark-submit-parent-b635f110-54db-44ca-972b-abdf100104a0;1.0
[2025-06-21T15:31:10.275-0300] {subprocess.py:93} INFO - 	confs: [default]
[2025-06-21T15:31:12.347-0300] {subprocess.py:93} INFO - 	found io.delta#delta-core_2.12;2.4.0 in central
[2025-06-21T15:31:12.396-0300] {subprocess.py:93} INFO - 	found io.delta#delta-storage;2.4.0 in central
[2025-06-21T15:31:12.438-0300] {subprocess.py:93} INFO - 	found org.antlr#antlr4-runtime;4.9.3 in central
[2025-06-21T15:31:12.482-0300] {subprocess.py:93} INFO - :: resolution report :: resolve 2192ms :: artifacts dl 16ms
[2025-06-21T15:31:12.483-0300] {subprocess.py:93} INFO - 	:: modules in use:
[2025-06-21T15:31:12.484-0300] {subprocess.py:93} INFO - 	io.delta#delta-core_2.12;2.4.0 from central in [default]
[2025-06-21T15:31:12.485-0300] {subprocess.py:93} INFO - 	io.delta#delta-storage;2.4.0 from central in [default]
[2025-06-21T15:31:12.486-0300] {subprocess.py:93} INFO - 	org.antlr#antlr4-runtime;4.9.3 from central in [default]
[2025-06-21T15:31:12.487-0300] {subprocess.py:93} INFO - 	---------------------------------------------------------------------
[2025-06-21T15:31:12.488-0300] {subprocess.py:93} INFO - 	|                  |            modules            ||   artifacts   |
[2025-06-21T15:31:12.489-0300] {subprocess.py:93} INFO - 	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
[2025-06-21T15:31:12.490-0300] {subprocess.py:93} INFO - 	---------------------------------------------------------------------
[2025-06-21T15:31:12.490-0300] {subprocess.py:93} INFO - 	|      default     |   3   |   0   |   0   |   0   ||   3   |   0   |
[2025-06-21T15:31:12.491-0300] {subprocess.py:93} INFO - 	---------------------------------------------------------------------
[2025-06-21T15:31:12.492-0300] {subprocess.py:93} INFO - :: retrieving :: org.apache.spark#spark-submit-parent-b635f110-54db-44ca-972b-abdf100104a0
[2025-06-21T15:31:12.493-0300] {subprocess.py:93} INFO - 	confs: [default]
[2025-06-21T15:31:12.504-0300] {subprocess.py:93} INFO - 	0 artifacts copied, 3 already retrieved (0kB/11ms)
[2025-06-21T15:31:13.110-0300] {subprocess.py:93} INFO - 25/06/21 15:31:13 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-06-21T15:31:13.807-0300] {subprocess.py:93} INFO - python3: can't open file '/mnt/c/Users/arcan/Documents/airflow/src/jobs/1-silver/coingecko/coingecko.py': [Errno 2] No such file or directory
[2025-06-21T15:31:13.830-0300] {subprocess.py:93} INFO - 25/06/21 15:31:13 INFO ShutdownHookManager: Shutdown hook called
[2025-06-21T15:31:13.834-0300] {subprocess.py:93} INFO - 25/06/21 15:31:13 INFO ShutdownHookManager: Deleting directory /tmp/spark-6cb8285d-07b7-4d96-a49a-b4f78371ec62
[2025-06-21T15:31:13.949-0300] {subprocess.py:97} INFO - Command exited with return code 2
[2025-06-21T15:31:13.971-0300] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/mnt/c/Users/arcan/Documents/airflow/.venv/lib/python3.10/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 2.
[2025-06-21T15:31:13.983-0300] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=PIPELINE_COINGECKO, task_id=run_silver_script, execution_date=20250621T182314, start_date=20250621T183103, end_date=20250621T183113
[2025-06-21T15:31:14.031-0300] {standard_task_runner.py:104} ERROR - Failed to execute job 38 for task run_silver_script (Bash command failed. The command returned a non-zero exit code 2.; 77652)
[2025-06-21T15:31:14.058-0300] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2025-06-21T15:31:14.093-0300] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
