[2025-06-21T15:43:50.075-0300] {logging_mixin.py:154} INFO - Changing /mnt/c/Users/arcan/Documents/airflow/logs/dag_id=PIPELINE_COINGECKO/run_id=manual__2025-06-21T18:36:14.987306+00:00/task_id=run_silver_script permission to 509
[2025-06-21T15:43:50.284-0300] {logging_mixin.py:154} INFO - Changing /mnt/c/Users/arcan/Documents/airflow/logs/dag_id=PIPELINE_COINGECKO/run_id=manual__2025-06-21T18:36:14.987306+00:00/task_id=run_silver_script permission to 509
[2025-06-21T15:43:50.494-0300] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: PIPELINE_COINGECKO.run_silver_script manual__2025-06-21T18:36:14.987306+00:00 [queued]>
[2025-06-21T15:43:50.519-0300] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: PIPELINE_COINGECKO.run_silver_script manual__2025-06-21T18:36:14.987306+00:00 [queued]>
[2025-06-21T15:43:50.520-0300] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2025-06-21T15:43:50.567-0300] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): run_silver_script> on 2025-06-21 18:36:14.987306+00:00
[2025-06-21T15:43:50.571-0300] {standard_task_runner.py:57} INFO - Started process 78580 to run task
[2025-06-21T15:43:50.576-0300] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'PIPELINE_COINGECKO', 'run_silver_script', 'manual__2025-06-21T18:36:14.987306+00:00', '--job-id', '43', '--raw', '--subdir', 'DAGS_FOLDER/pipeline_coingecko.py', '--cfg-path', '/tmp/tmp5sntm0il']
[2025-06-21T15:43:50.578-0300] {standard_task_runner.py:85} INFO - Job 43: Subtask run_silver_script
[2025-06-21T15:43:50.676-0300] {logging_mixin.py:154} INFO - Changing /mnt/c/Users/arcan/Documents/airflow/logs/dag_id=PIPELINE_COINGECKO/run_id=manual__2025-06-21T18:36:14.987306+00:00/task_id=run_silver_script permission to 509
[2025-06-21T15:43:50.697-0300] {task_command.py:416} INFO - Running <TaskInstance: PIPELINE_COINGECKO.run_silver_script manual__2025-06-21T18:36:14.987306+00:00 [running]> on host YanArcanjo.localdomain
[2025-06-21T15:43:50.884-0300] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='yan_arcanjo' AIRFLOW_CTX_DAG_ID='PIPELINE_COINGECKO' AIRFLOW_CTX_TASK_ID='run_silver_script' AIRFLOW_CTX_EXECUTION_DATE='2025-06-21T18:36:14.987306+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-21T18:36:14.987306+00:00'
[2025-06-21T15:43:50.888-0300] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-21T15:43:50.891-0300] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'spark-submit --packages io.delta:delta-core_2.12:2.4.0             --master local[*]             --conf "spark.sql.extensions=io.delta.sql.DeltaSparkSessionExtension"             --conf "spark.sql.catalog.spark_catalog=org.apache.spark.sql.delta.catalog.DeltaCatalog"             --conf "spark.driver.extraJavaOptions=-Dlog4j.configurationFile=src/jobs/log4j2.properties"             /mnt/c/Users/arcan/Documents/airflow/src/jobs/2-silver/coingecko/coingecko.py coingecko']
[2025-06-21T15:43:50.904-0300] {subprocess.py:86} INFO - Output:
[2025-06-21T15:43:54.850-0300] {subprocess.py:93} INFO - ERROR StatusLogger Reconfiguration failed: No configuration found for '53bd815b' at 'null' in 'null'
[2025-06-21T15:43:54.863-0300] {subprocess.py:93} INFO - ERROR StatusLogger Reconfiguration failed: No configuration found for 'Default' at 'null' in 'null'
[2025-06-21T15:43:55.426-0300] {subprocess.py:93} INFO - 25/06/21 15:43:55 WARN Utils: Your hostname, YanArcanjo resolves to a loopback address: 127.0.1.1; using 10.255.255.254 instead (on interface lo)
[2025-06-21T15:43:55.435-0300] {subprocess.py:93} INFO - 25/06/21 15:43:55 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
[2025-06-21T15:43:55.975-0300] {subprocess.py:93} INFO - :: loading settings :: url = jar:file:/mnt/c/Users/arcan/Documents/airflow/.venv/lib/python3.10/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
[2025-06-21T15:43:56.096-0300] {subprocess.py:93} INFO - Ivy Default Cache set to: /home/yanarcanjo/.ivy2/cache
[2025-06-21T15:43:56.097-0300] {subprocess.py:93} INFO - The jars for the packages stored in: /home/yanarcanjo/.ivy2/jars
[2025-06-21T15:43:56.107-0300] {subprocess.py:93} INFO - io.delta#delta-core_2.12 added as a dependency
[2025-06-21T15:43:56.108-0300] {subprocess.py:93} INFO - :: resolving dependencies :: org.apache.spark#spark-submit-parent-d723b2f4-4393-4ce0-98d1-96722ef8ba87;1.0
[2025-06-21T15:43:56.109-0300] {subprocess.py:93} INFO - 	confs: [default]
[2025-06-21T15:43:56.261-0300] {subprocess.py:93} INFO - 	found io.delta#delta-core_2.12;2.4.0 in central
[2025-06-21T15:43:56.320-0300] {subprocess.py:93} INFO - 	found io.delta#delta-storage;2.4.0 in central
[2025-06-21T15:43:56.351-0300] {subprocess.py:93} INFO - 	found org.antlr#antlr4-runtime;4.9.3 in central
[2025-06-21T15:43:56.382-0300] {subprocess.py:93} INFO - :: resolution report :: resolve 267ms :: artifacts dl 7ms
[2025-06-21T15:43:56.385-0300] {subprocess.py:93} INFO - 	:: modules in use:
[2025-06-21T15:43:56.386-0300] {subprocess.py:93} INFO - 	io.delta#delta-core_2.12;2.4.0 from central in [default]
[2025-06-21T15:43:56.387-0300] {subprocess.py:93} INFO - 	io.delta#delta-storage;2.4.0 from central in [default]
[2025-06-21T15:43:56.387-0300] {subprocess.py:93} INFO - 	org.antlr#antlr4-runtime;4.9.3 from central in [default]
[2025-06-21T15:43:56.388-0300] {subprocess.py:93} INFO - 	---------------------------------------------------------------------
[2025-06-21T15:43:56.388-0300] {subprocess.py:93} INFO - 	|                  |            modules            ||   artifacts   |
[2025-06-21T15:43:56.389-0300] {subprocess.py:93} INFO - 	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
[2025-06-21T15:43:56.390-0300] {subprocess.py:93} INFO - 	---------------------------------------------------------------------
[2025-06-21T15:43:56.390-0300] {subprocess.py:93} INFO - 	|      default     |   3   |   0   |   0   |   0   ||   3   |   0   |
[2025-06-21T15:43:56.390-0300] {subprocess.py:93} INFO - 	---------------------------------------------------------------------
[2025-06-21T15:43:56.391-0300] {subprocess.py:93} INFO - :: retrieving :: org.apache.spark#spark-submit-parent-d723b2f4-4393-4ce0-98d1-96722ef8ba87
[2025-06-21T15:43:56.392-0300] {subprocess.py:93} INFO - 	confs: [default]
[2025-06-21T15:43:56.397-0300] {subprocess.py:93} INFO - 	0 artifacts copied, 3 already retrieved (0kB/8ms)
[2025-06-21T15:43:56.879-0300] {subprocess.py:93} INFO - 25/06/21 15:43:56 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-06-21T15:43:58.763-0300] {subprocess.py:93} INFO - 2025-06-21 15:43:58,762 - INFO - Iniciando criação da Spark Session
[2025-06-21T15:43:58.953-0300] {subprocess.py:93} INFO - 25/06/21 15:43:58 INFO SparkContext: Running Spark version 3.4.2
[2025-06-21T15:43:59.007-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO ResourceUtils: ==============================================================
[2025-06-21T15:43:59.009-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO ResourceUtils: No custom resources configured for spark.driver.
[2025-06-21T15:43:59.010-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO ResourceUtils: ==============================================================
[2025-06-21T15:43:59.010-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO SparkContext: Submitted application: Spark - Silver
[2025-06-21T15:43:59.099-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
[2025-06-21T15:43:59.120-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO ResourceProfile: Limiting resource is cpu
[2025-06-21T15:43:59.120-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO ResourceProfileManager: Added ResourceProfile id: 0
[2025-06-21T15:43:59.318-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO SecurityManager: Changing view acls to: yanarcanjo
[2025-06-21T15:43:59.319-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO SecurityManager: Changing modify acls to: yanarcanjo
[2025-06-21T15:43:59.320-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO SecurityManager: Changing view acls groups to:
[2025-06-21T15:43:59.321-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO SecurityManager: Changing modify acls groups to:
[2025-06-21T15:43:59.321-0300] {subprocess.py:93} INFO - 25/06/21 15:43:59 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: yanarcanjo; groups with view permissions: EMPTY; users with modify permissions: yanarcanjo; groups with modify permissions: EMPTY
[2025-06-21T15:44:00.029-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO Utils: Successfully started service 'sparkDriver' on port 33125.
[2025-06-21T15:44:00.102-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO SparkEnv: Registering MapOutputTracker
[2025-06-21T15:44:00.208-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO SparkEnv: Registering BlockManagerMaster
[2025-06-21T15:44:00.296-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[2025-06-21T15:44:00.297-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
[2025-06-21T15:44:00.303-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
[2025-06-21T15:44:00.385-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-90f0139c-3c4f-401d-83af-5efa9c29b174
[2025-06-21T15:44:00.434-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
[2025-06-21T15:44:00.472-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO SparkEnv: Registering OutputCommitCoordinator
[2025-06-21T15:44:00.871-0300] {subprocess.py:93} INFO - 25/06/21 15:44:00 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
[2025-06-21T15:44:01.036-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
[2025-06-21T15:44:01.038-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
[2025-06-21T15:44:01.062-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Utils: Successfully started service 'SparkUI' on port 4042.
[2025-06-21T15:44:01.143-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO SparkContext: Added JAR file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar at spark://10.255.255.254:33125/jars/io.delta_delta-core_2.12-2.4.0.jar with timestamp 1750531438935
[2025-06-21T15:44:01.144-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO SparkContext: Added JAR file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar at spark://10.255.255.254:33125/jars/io.delta_delta-storage-2.4.0.jar with timestamp 1750531438935
[2025-06-21T15:44:01.144-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO SparkContext: Added JAR file:///home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar at spark://10.255.255.254:33125/jars/org.antlr_antlr4-runtime-4.9.3.jar with timestamp 1750531438935
[2025-06-21T15:44:01.148-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO SparkContext: Added file file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar at file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar with timestamp 1750531438935
[2025-06-21T15:44:01.151-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Utils: Copying /home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/io.delta_delta-core_2.12-2.4.0.jar
[2025-06-21T15:44:01.184-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO SparkContext: Added file file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar at file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar with timestamp 1750531438935
[2025-06-21T15:44:01.185-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Utils: Copying /home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/io.delta_delta-storage-2.4.0.jar
[2025-06-21T15:44:01.193-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO SparkContext: Added file file:///home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar at file:///home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar with timestamp 1750531438935
[2025-06-21T15:44:01.194-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Utils: Copying /home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/org.antlr_antlr4-runtime-4.9.3.jar
[2025-06-21T15:44:01.374-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Executor: Starting executor ID driver on host 10.255.255.254
[2025-06-21T15:44:01.388-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
[2025-06-21T15:44:01.424-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Executor: Fetching file:///home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar with timestamp 1750531438935
[2025-06-21T15:44:01.473-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Utils: /home/yanarcanjo/.ivy2/jars/org.antlr_antlr4-runtime-4.9.3.jar has been previously copied to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/org.antlr_antlr4-runtime-4.9.3.jar
[2025-06-21T15:44:01.480-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Executor: Fetching file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar with timestamp 1750531438935
[2025-06-21T15:44:01.485-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Utils: /home/yanarcanjo/.ivy2/jars/io.delta_delta-core_2.12-2.4.0.jar has been previously copied to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/io.delta_delta-core_2.12-2.4.0.jar
[2025-06-21T15:44:01.494-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Executor: Fetching file:///home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar with timestamp 1750531438935
[2025-06-21T15:44:01.495-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Utils: /home/yanarcanjo/.ivy2/jars/io.delta_delta-storage-2.4.0.jar has been previously copied to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/io.delta_delta-storage-2.4.0.jar
[2025-06-21T15:44:01.505-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Executor: Fetching spark://10.255.255.254:33125/jars/io.delta_delta-core_2.12-2.4.0.jar with timestamp 1750531438935
[2025-06-21T15:44:01.638-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO TransportClientFactory: Successfully created connection to /10.255.255.254:33125 after 104 ms (0 ms spent in bootstraps)
[2025-06-21T15:44:01.663-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Utils: Fetching spark://10.255.255.254:33125/jars/io.delta_delta-core_2.12-2.4.0.jar to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/fetchFileTemp5765020464205041211.tmp
[2025-06-21T15:44:01.776-0300] {subprocess.py:93} INFO - 25/06/21 15:44:01 INFO Utils: /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/fetchFileTemp5765020464205041211.tmp has been previously copied to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/io.delta_delta-core_2.12-2.4.0.jar
[2025-06-21T15:44:02.025-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Executor: Adding file:/tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/io.delta_delta-core_2.12-2.4.0.jar to class loader
[2025-06-21T15:44:02.026-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Executor: Fetching spark://10.255.255.254:33125/jars/org.antlr_antlr4-runtime-4.9.3.jar with timestamp 1750531438935
[2025-06-21T15:44:02.027-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Utils: Fetching spark://10.255.255.254:33125/jars/org.antlr_antlr4-runtime-4.9.3.jar to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/fetchFileTemp2509276485961088341.tmp
[2025-06-21T15:44:02.032-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Utils: /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/fetchFileTemp2509276485961088341.tmp has been previously copied to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/org.antlr_antlr4-runtime-4.9.3.jar
[2025-06-21T15:44:02.077-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Executor: Adding file:/tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/org.antlr_antlr4-runtime-4.9.3.jar to class loader
[2025-06-21T15:44:02.077-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Executor: Fetching spark://10.255.255.254:33125/jars/io.delta_delta-storage-2.4.0.jar with timestamp 1750531438935
[2025-06-21T15:44:02.078-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Utils: Fetching spark://10.255.255.254:33125/jars/io.delta_delta-storage-2.4.0.jar to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/fetchFileTemp2062949825966503969.tmp
[2025-06-21T15:44:02.080-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Utils: /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/fetchFileTemp2062949825966503969.tmp has been previously copied to /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/io.delta_delta-storage-2.4.0.jar
[2025-06-21T15:44:02.088-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Executor: Adding file:/tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/userFiles-20252a3a-390b-4460-abd5-fd43e1090282/io.delta_delta-storage-2.4.0.jar to class loader
[2025-06-21T15:44:02.102-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 35927.
[2025-06-21T15:44:02.104-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO NettyBlockTransferService: Server created on 10.255.255.254:35927
[2025-06-21T15:44:02.106-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[2025-06-21T15:44:02.129-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 10.255.255.254, 35927, None)
[2025-06-21T15:44:02.137-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO BlockManagerMasterEndpoint: Registering block manager 10.255.255.254:35927 with 366.3 MiB RAM, BlockManagerId(driver, 10.255.255.254, 35927, None)
[2025-06-21T15:44:02.141-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 10.255.255.254, 35927, None)
[2025-06-21T15:44:02.144-0300] {subprocess.py:93} INFO - 25/06/21 15:44:02 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 10.255.255.254, 35927, None)
[2025-06-21T15:44:03.154-0300] {subprocess.py:93} INFO - 2025-06-21 15:44:03,154 - INFO - Criação da Spark Session Finalizada
[2025-06-21T15:44:03.155-0300] {subprocess.py:93} INFO - 2025-06-21 15:44:03,154 - INFO - Inicio do processamento para coingecko as 2025-06-21 15:43:58
[2025-06-21T15:44:03.156-0300] {subprocess.py:93} INFO - 2025-06-21 15:44:03,154 - INFO - Lendo delta bronze -> /mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko...
[2025-06-21T15:44:03.230-0300] {subprocess.py:93} INFO - 25/06/21 15:44:03 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
[2025-06-21T15:44:03.234-0300] {subprocess.py:93} INFO - 25/06/21 15:44:03 INFO SharedState: Warehouse path is 'file:/tmp/airflowtmpfzbec_wh/spark-warehouse'.
[2025-06-21T15:44:06.351-0300] {subprocess.py:93} INFO - 25/06/21 15:44:06 INFO DelegatingLogStore: LogStore `LogStoreAdapter(io.delta.storage.HDFSLogStore)` is used for scheme `file`
[2025-06-21T15:44:06.710-0300] {subprocess.py:93} INFO - 25/06/21 15:44:06 INFO DeltaLog: Loading version 7.
[2025-06-21T15:44:10.255-0300] {subprocess.py:93} INFO - 25/06/21 15:44:10 INFO DeltaLogFileIndex: Created DeltaLogFileIndex(JSON, numFilesInSegment: 8, totalFileSize: 34655)
[2025-06-21T15:44:12.737-0300] {subprocess.py:93} INFO - 25/06/21 15:44:12 INFO FileSourceStrategy: Pushed Filters:
[2025-06-21T15:44:12.738-0300] {subprocess.py:93} INFO - 25/06/21 15:44:12 INFO FileSourceStrategy: Post-Scan Filters:
[2025-06-21T15:44:14.201-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO CodeGenerator: Code generated in 804.115056 ms
[2025-06-21T15:44:14.368-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 354.5 KiB, free 366.0 MiB)
[2025-06-21T15:44:14.527-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 365.9 MiB)
[2025-06-21T15:44:14.534-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 10.255.255.254:35927 (size: 35.4 KiB, free: 366.3 MiB)
[2025-06-21T15:44:14.544-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO SparkContext: Created broadcast 0 from toString at String.java:2994
[2025-06-21T15:44:14.601-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2025-06-21T15:44:14.939-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO SparkContext: Starting job: toString at String.java:2994
[2025-06-21T15:44:14.972-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO DAGScheduler: Got job 0 (toString at String.java:2994) with 8 output partitions
[2025-06-21T15:44:14.973-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO DAGScheduler: Final stage: ResultStage 0 (toString at String.java:2994)
[2025-06-21T15:44:14.974-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO DAGScheduler: Parents of final stage: List()
[2025-06-21T15:44:14.976-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO DAGScheduler: Missing parents: List()
[2025-06-21T15:44:14.984-0300] {subprocess.py:93} INFO - 25/06/21 15:44:14 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at toString at String.java:2994), which has no missing parents
[2025-06-21T15:44:15.032-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 50.4 KiB, free 365.9 MiB)
[2025-06-21T15:44:15.038-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 15.6 KiB, free 365.9 MiB)
[2025-06-21T15:44:15.039-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 10.255.255.254:35927 (size: 15.6 KiB, free: 366.3 MiB)
[2025-06-21T15:44:15.040-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1535
[2025-06-21T15:44:15.070-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO DAGScheduler: Submitting 8 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at toString at String.java:2994) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
[2025-06-21T15:44:15.073-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO TaskSchedulerImpl: Adding task set 0.0 with 8 tasks resource profile 0
[2025-06-21T15:44:15.175-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (10.255.255.254, executor driver, partition 0, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T15:44:15.182-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO TaskSetManager: Starting task 1.0 in stage 0.0 (TID 1) (10.255.255.254, executor driver, partition 1, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T15:44:15.183-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO TaskSetManager: Starting task 2.0 in stage 0.0 (TID 2) (10.255.255.254, executor driver, partition 2, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T15:44:15.184-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO TaskSetManager: Starting task 3.0 in stage 0.0 (TID 3) (10.255.255.254, executor driver, partition 3, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T15:44:15.185-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO TaskSetManager: Starting task 4.0 in stage 0.0 (TID 4) (10.255.255.254, executor driver, partition 4, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T15:44:15.186-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO TaskSetManager: Starting task 5.0 in stage 0.0 (TID 5) (10.255.255.254, executor driver, partition 5, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T15:44:15.187-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO TaskSetManager: Starting task 6.0 in stage 0.0 (TID 6) (10.255.255.254, executor driver, partition 6, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T15:44:15.188-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO TaskSetManager: Starting task 7.0 in stage 0.0 (TID 7) (10.255.255.254, executor driver, partition 7, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T15:44:15.209-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO Executor: Running task 5.0 in stage 0.0 (TID 5)
[2025-06-21T15:44:15.209-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
[2025-06-21T15:44:15.210-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO Executor: Running task 6.0 in stage 0.0 (TID 6)
[2025-06-21T15:44:15.210-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO Executor: Running task 4.0 in stage 0.0 (TID 4)
[2025-06-21T15:44:15.210-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO Executor: Running task 7.0 in stage 0.0 (TID 7)
[2025-06-21T15:44:15.211-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO Executor: Running task 1.0 in stage 0.0 (TID 1)
[2025-06-21T15:44:15.211-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO Executor: Running task 2.0 in stage 0.0 (TID 2)
[2025-06-21T15:44:15.212-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO Executor: Running task 3.0 in stage 0.0 (TID 3)
[2025-06-21T15:44:15.828-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000007.json, range: 0-4050, partition values: [empty row]
[2025-06-21T15:44:15.829-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000001.json, range: 0-2925, partition values: [empty row]
[2025-06-21T15:44:15.831-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000003.json, range: 0-4048, partition values: [empty row]
[2025-06-21T15:44:15.832-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000004.json, range: 0-4050, partition values: [empty row]
[2025-06-21T15:44:15.833-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000006.json, range: 0-4046, partition values: [empty row]
[2025-06-21T15:44:15.834-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000000.json, range: 0-5049, partition values: [empty row]
[2025-06-21T15:44:15.835-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000002.json, range: 0-6443, partition values: [empty row]
[2025-06-21T15:44:15.835-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000005.json, range: 0-4044, partition values: [empty row]
[2025-06-21T15:44:15.926-0300] {subprocess.py:93} INFO - 25/06/21 15:44:15 INFO CodeGenerator: Code generated in 78.986696 ms
[2025-06-21T15:44:16.335-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO Executor: Finished task 7.0 in stage 0.0 (TID 7). 1673 bytes result sent to driver
[2025-06-21T15:44:16.336-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 2402 bytes result sent to driver
[2025-06-21T15:44:16.337-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO Executor: Finished task 1.0 in stage 0.0 (TID 1). 2347 bytes result sent to driver
[2025-06-21T15:44:16.339-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO Executor: Finished task 6.0 in stage 0.0 (TID 6). 1673 bytes result sent to driver
[2025-06-21T15:44:16.340-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO Executor: Finished task 2.0 in stage 0.0 (TID 2). 1673 bytes result sent to driver
[2025-06-21T15:44:16.341-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO Executor: Finished task 4.0 in stage 0.0 (TID 4). 1673 bytes result sent to driver
[2025-06-21T15:44:16.342-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO Executor: Finished task 3.0 in stage 0.0 (TID 3). 1673 bytes result sent to driver
[2025-06-21T15:44:16.343-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO Executor: Finished task 5.0 in stage 0.0 (TID 5). 1673 bytes result sent to driver
[2025-06-21T15:44:16.363-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSetManager: Finished task 5.0 in stage 0.0 (TID 5) in 1176 ms on 10.255.255.254 (executor driver) (1/8)
[2025-06-21T15:44:16.369-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSetManager: Finished task 6.0 in stage 0.0 (TID 6) in 1182 ms on 10.255.255.254 (executor driver) (2/8)
[2025-06-21T15:44:16.370-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSetManager: Finished task 2.0 in stage 0.0 (TID 2) in 1187 ms on 10.255.255.254 (executor driver) (3/8)
[2025-06-21T15:44:16.371-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSetManager: Finished task 7.0 in stage 0.0 (TID 7) in 1183 ms on 10.255.255.254 (executor driver) (4/8)
[2025-06-21T15:44:16.372-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1213 ms on 10.255.255.254 (executor driver) (5/8)
[2025-06-21T15:44:16.374-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSetManager: Finished task 3.0 in stage 0.0 (TID 3) in 1188 ms on 10.255.255.254 (executor driver) (6/8)
[2025-06-21T15:44:16.375-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSetManager: Finished task 1.0 in stage 0.0 (TID 1) in 1191 ms on 10.255.255.254 (executor driver) (7/8)
[2025-06-21T15:44:16.376-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSetManager: Finished task 4.0 in stage 0.0 (TID 4) in 1188 ms on 10.255.255.254 (executor driver) (8/8)
[2025-06-21T15:44:16.377-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool
[2025-06-21T15:44:16.396-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO DAGScheduler: ResultStage 0 (toString at String.java:2994) finished in 1.373 s
[2025-06-21T15:44:16.402-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
[2025-06-21T15:44:16.403-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
[2025-06-21T15:44:16.407-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO DAGScheduler: Job 0 finished: toString at String.java:2994, took 1.467132 s
[2025-06-21T15:44:16.537-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO CodeGenerator: Code generated in 71.888771 ms
[2025-06-21T15:44:16.564-0300] {subprocess.py:93} INFO - 25/06/21 15:44:16 INFO Snapshot: [tableId=bed32d89-116e-4d2d-b7e7-064138d93282] Created snapshot Snapshot(path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log, version=7, metadata=Metadata(02c8a9fd-7688-4d17-b5bb-6360b5fc3af6,null,null,Format(parquet,Map()),{"type":"struct","fields":[{"name":"ath","type":"double","nullable":true,"metadata":{}},{"name":"ath_change_percentage","type":"double","nullable":true,"metadata":{}},{"name":"ath_date","type":"string","nullable":true,"metadata":{}},{"name":"atl","type":"double","nullable":true,"metadata":{}},{"name":"atl_change_percentage","type":"double","nullable":true,"metadata":{}},{"name":"atl_date","type":"string","nullable":true,"metadata":{}},{"name":"circulating_supply","type":"double","nullable":true,"metadata":{}},{"name":"current_price","type":"double","nullable":true,"metadata":{}},{"name":"fully_diluted_valuation","type":"long","nullable":true,"metadata":{}},{"name":"high_24h","type":"double","nullable":true,"metadata":{}},{"name":"id","type":"string","nullable":true,"metadata":{}},{"name":"image","type":"string","nullable":true,"metadata":{}},{"name":"last_updated","type":"string","nullable":true,"metadata":{}},{"name":"low_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap","type":"long","nullable":true,"metadata":{}},{"name":"market_cap_change_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap_change_percentage_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap_rank","type":"long","nullable":true,"metadata":{}},{"name":"max_supply","type":"double","nullable":true,"metadata":{}},{"name":"name","type":"string","nullable":true,"metadata":{}},{"name":"price_change_24h","type":"double","nullable":true,"metadata":{}},{"name":"price_change_percentage_24h","type":"double","nullable":true,"metadata":{}},{"name":"symbol","type":"string","nullable":true,"metadata":{}},{"name":"total_supply","type":"double","nullable":true,"metadata":{}},{"name":"total_volume","type":"double","nullable":true,"metadata":{}},{"name":"key_log_file_path","type":"string","nullable":true,"metadata":{}},{"name":"dt_atualizacao","type":"string","nullable":true,"metadata":{}},{"name":"dt_ingestao","type":"string","nullable":true,"metadata":{}},{"name":"nm_arquivo_origem","type":"string","nullable":true,"metadata":{}},{"name":"hash_chave","type":"string","nullable":true,"metadata":{}},{"name":"hash_columns","type":"string","nullable":true,"metadata":{}}]},List(),Map(),Some(1750355014043)), logSegment=LogSegment(file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log,7,WrappedArray(DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000000.json; isDirectory=false; length=5049; replication=1; blocksize=33554432; modification_time=1750355014370; access_time=1750355014370; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000001.json; isDirectory=false; length=2925; replication=1; blocksize=33554432; modification_time=1750356194967; access_time=1750356194967; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000002.json; isDirectory=false; length=6443; replication=1; blocksize=33554432; modification_time=1750356316261; access_time=1750356316261; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000003.json; isDirectory=false; length=4048; replication=1; blocksize=33554432; modification_time=1750357036143; access_time=1750357036143; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000004.json; isDirectory=false; length=4050; replication=1; blocksize=33554432; modification_time=1750358332518; access_time=1750358332518; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000005.json; isDirectory=false; length=4044; replication=1; blocksize=33554432; modification_time=1750359006032; access_time=1750359006032; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000006.json; isDirectory=false; length=4046; replication=1; blocksize=33554432; modification_time=1750530297326; access_time=1750530297326; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}, DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/2-bronze/coingecko/_delta_log/00000000000000000007.json; isDirectory=false; length=4050; replication=1; blocksize=33554432; modification_time=1750531389467; access_time=1750531389467; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}),None,1750531389467), checksumOpt=None)
[2025-06-21T15:44:16.837-0300] {subprocess.py:93} INFO - 2025-06-21 15:44:16,837 - INFO - Selecionando os registros mais recentes de cada hash chave
[2025-06-21T15:44:17.111-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DelegatingLogStore: LogStore `LogStoreAdapter(io.delta.storage.HDFSLogStore)` is used for scheme `file`
[2025-06-21T15:44:17.178-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DeltaLog: Loading version 0.
[2025-06-21T15:44:17.185-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DeltaLogFileIndex: Created DeltaLogFileIndex(JSON, numFilesInSegment: 1, totalFileSize: 6272)
[2025-06-21T15:44:17.279-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO FileSourceStrategy: Pushed Filters:
[2025-06-21T15:44:17.280-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO FileSourceStrategy: Post-Scan Filters:
[2025-06-21T15:44:17.317-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 354.5 KiB, free 365.5 MiB)
[2025-06-21T15:44:17.328-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 365.5 MiB)
[2025-06-21T15:44:17.332-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 10.255.255.254:35927 (size: 35.4 KiB, free: 366.2 MiB)
[2025-06-21T15:44:17.333-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO SparkContext: Created broadcast 2 from toString at String.java:2994
[2025-06-21T15:44:17.335-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2025-06-21T15:44:17.361-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO SparkContext: Starting job: toString at String.java:2994
[2025-06-21T15:44:17.363-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DAGScheduler: Got job 1 (toString at String.java:2994) with 1 output partitions
[2025-06-21T15:44:17.364-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DAGScheduler: Final stage: ResultStage 1 (toString at String.java:2994)
[2025-06-21T15:44:17.364-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DAGScheduler: Parents of final stage: List()
[2025-06-21T15:44:17.365-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DAGScheduler: Missing parents: List()
[2025-06-21T15:44:17.366-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[7] at toString at String.java:2994), which has no missing parents
[2025-06-21T15:44:17.370-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 50.4 KiB, free 365.4 MiB)
[2025-06-21T15:44:17.373-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 15.6 KiB, free 365.4 MiB)
[2025-06-21T15:44:17.375-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 10.255.255.254:35927 (size: 15.6 KiB, free: 366.2 MiB)
[2025-06-21T15:44:17.376-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1535
[2025-06-21T15:44:17.377-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[7] at toString at String.java:2994) (first 15 tasks are for partitions Vector(0))
[2025-06-21T15:44:17.378-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks resource profile 0
[2025-06-21T15:44:17.380-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 8) (10.255.255.254, executor driver, partition 0, PROCESS_LOCAL, 7984 bytes)
[2025-06-21T15:44:17.381-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO Executor: Running task 0.0 in stage 1.0 (TID 8)
[2025-06-21T15:44:17.388-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO FileScanRDD: Reading File path: file:///mnt/c/Users/arcan/Documents/airflow/data/3-silver/coingecko/_delta_log/00000000000000000000.json, range: 0-6272, partition values: [empty row]
[2025-06-21T15:44:17.456-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO Executor: Finished task 0.0 in stage 1.0 (TID 8). 2364 bytes result sent to driver
[2025-06-21T15:44:17.460-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 8) in 81 ms on 10.255.255.254 (executor driver) (1/1)
[2025-06-21T15:44:17.461-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool
[2025-06-21T15:44:17.462-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DAGScheduler: ResultStage 1 (toString at String.java:2994) finished in 0.095 s
[2025-06-21T15:44:17.463-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
[2025-06-21T15:44:17.464-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
[2025-06-21T15:44:17.464-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO DAGScheduler: Job 1 finished: toString at String.java:2994, took 0.102793 s
[2025-06-21T15:44:17.483-0300] {subprocess.py:93} INFO - 25/06/21 15:44:17 INFO Snapshot: [tableId=e4be484b-076c-495f-b71c-cf73470a9baf] Created snapshot Snapshot(path=file:/mnt/c/Users/arcan/Documents/airflow/data/3-silver/coingecko/_delta_log, version=0, metadata=Metadata(87c52a9c-9162-4131-83ba-34d9aee57383,null,null,Format(parquet,Map()),{"type":"struct","fields":[{"name":"ath","type":"double","nullable":true,"metadata":{}},{"name":"ath_change_percentage","type":"double","nullable":true,"metadata":{}},{"name":"ath_date","type":"string","nullable":true,"metadata":{}},{"name":"atl","type":"double","nullable":true,"metadata":{}},{"name":"atl_change_percentage","type":"double","nullable":true,"metadata":{}},{"name":"atl_date","type":"string","nullable":true,"metadata":{}},{"name":"circulating_supply","type":"double","nullable":true,"metadata":{}},{"name":"current_price","type":"double","nullable":true,"metadata":{}},{"name":"fully_diluted_valuation","type":"long","nullable":true,"metadata":{}},{"name":"high_24h","type":"double","nullable":true,"metadata":{}},{"name":"id","type":"string","nullable":true,"metadata":{}},{"name":"image","type":"string","nullable":true,"metadata":{}},{"name":"last_updated","type":"string","nullable":true,"metadata":{}},{"name":"low_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap","type":"long","nullable":true,"metadata":{}},{"name":"market_cap_change_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap_change_percentage_24h","type":"double","nullable":true,"metadata":{}},{"name":"market_cap_rank","type":"long","nullable":true,"metadata":{}},{"name":"max_supply","type":"double","nullable":true,"metadata":{}},{"name":"name","type":"string","nullable":true,"metadata":{}},{"name":"price_change_24h","type":"double","nullable":true,"metadata":{}},{"name":"price_change_percentage_24h","type":"double","nullable":true,"metadata":{}},{"name":"symbol","type":"string","nullable":true,"metadata":{}},{"name":"total_supply","type":"double","nullable":true,"metadata":{}},{"name":"total_volume","type":"double","nullable":true,"metadata":{}},{"name":"hash_chave","type":"string","nullable":true,"metadata":{}},{"name":"hash_columns","type":"string","nullable":true,"metadata":{}},{"name":"key_log_file_path","type":"string","nullable":true,"metadata":{}},{"name":"dt_atualizacao","type":"string","nullable":true,"metadata":{}},{"name":"dt_ingestao","type":"string","nullable":true,"metadata":{}},{"name":"nm_arquivo_origem","type":"string","nullable":true,"metadata":{}}]},List(),Map(),Some(1750528855635)), logSegment=LogSegment(file:/mnt/c/Users/arcan/Documents/airflow/data/3-silver/coingecko/_delta_log,0,WrappedArray(DeprecatedRawLocalFileStatus{path=file:/mnt/c/Users/arcan/Documents/airflow/data/3-silver/coingecko/_delta_log/00000000000000000000.json; isDirectory=false; length=6272; replication=1; blocksize=33554432; modification_time=1750528861569; access_time=1750528861569; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false}),None,1750528861569), checksumOpt=None)
[2025-06-21T15:44:17.487-0300] {subprocess.py:93} INFO - 2025-06-21 15:44:17,486 - INFO - Filtrando os dados que necessitam ser atualizados ou inseridos
[2025-06-21T15:44:17.607-0300] {subprocess.py:93} INFO - 2025-06-21 15:44:17,607 - ERROR - Erro na execução: 'DataFrame' object has no attribute 'hash_colums'
[2025-06-21T15:44:17.608-0300] {subprocess.py:93} INFO - 2025-06-21 15:44:17,607 - INFO - Closing down clientserver connection
[2025-06-21T15:44:19.716-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO SparkContext: Invoking stop() from shutdown hook
[2025-06-21T15:44:19.717-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO SparkContext: SparkContext is stopping with exitCode 0.
[2025-06-21T15:44:19.745-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO SparkUI: Stopped Spark web UI at http://10.255.255.254:4042
[2025-06-21T15:44:19.778-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
[2025-06-21T15:44:19.799-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO MemoryStore: MemoryStore cleared
[2025-06-21T15:44:19.800-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO BlockManager: BlockManager stopped
[2025-06-21T15:44:19.825-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO BlockManagerMaster: BlockManagerMaster stopped
[2025-06-21T15:44:19.831-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
[2025-06-21T15:44:19.842-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO SparkContext: Successfully stopped SparkContext
[2025-06-21T15:44:19.843-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO ShutdownHookManager: Shutdown hook called
[2025-06-21T15:44:19.843-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO ShutdownHookManager: Deleting directory /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e
[2025-06-21T15:44:19.849-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO ShutdownHookManager: Deleting directory /tmp/spark-b3898bfd-eaca-4641-bff4-52b0efea622e/pyspark-d270dedf-5770-4a10-9d69-e9338150c810
[2025-06-21T15:44:19.857-0300] {subprocess.py:93} INFO - 25/06/21 15:44:19 INFO ShutdownHookManager: Deleting directory /tmp/spark-e4716c40-78d4-40d6-b5da-279ceea944c9
[2025-06-21T15:44:20.059-0300] {subprocess.py:97} INFO - Command exited with return code 0
[2025-06-21T15:44:20.119-0300] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=PIPELINE_COINGECKO, task_id=run_silver_script, execution_date=20250621T183614, start_date=20250621T184350, end_date=20250621T184420
[2025-06-21T15:44:20.213-0300] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-06-21T15:44:20.246-0300] {taskinstance.py:2778} INFO - 1 downstream tasks scheduled from follow-on schedule check
